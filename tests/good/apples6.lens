var totalApples = 0;
var warning = false;

match {
    "(?<numApples>\d+) apples# numApples:int";
    "^(?<name>[^ ]*)"
}

stream {
    print(entry.name);
}

stream {
    totalApples += entry.numApples || 0;
    if(totalApples > 10 && !warning) {
      	warning = true;
    	entry.activate = true;
    }
}

stream when (entry.activate){
    print("We picked too many apples: " + totalApples);
}

